<!doctype html><html lang="id"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Postest Bimbingan Perkawinan</title><style>*,*:before,*:after{box-sizing:border-box}body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,sans-serif;background:linear-gradient(#ecfdf5,#fff)}.wrap{max-width:1060px;margin:0 auto;padding:16px}.nav{position:sticky;top:0;z-index:9;background:#ffffffc7;backdrop-filter:blur(8px);border-bottom:1px solid #e2e8f0}.navin{display:flex;align-items:center;justify-content:space-between;gap:8px;padding:10px 16px;max-width:1160px;margin:0 auto}.brand{display:flex;align-items:center;gap:8px;font-weight:800}.logo{width:28px;height:28px;border-radius:6px;object-fit:cover;display:none}.badge{width:28px;height:28px;border-radius:6px;background:#059669}.btn{padding:8px 12px;border-radius:12px;border:1px solid #e2e8f0;background:#059669;color:#fff;font-weight:700;cursor:pointer}.btn.ghost{background:#fff;color:#065f46}.btn.dan{background:#e11d48}.btn.mute{background:#0f172a}.card{background:#fff;border:1px solid #e2e8f0;border-radius:16px;padding:14px}.title{font-weight:800;color:#0f172a}.sub{color:#64748b;font-size:13px}.lab{display:block;margin:6px 0 4px;color:#334155;font-weight:600;font-size:13px}.inp,.ta{width:100%;border:1px solid #cbd5e1;border-radius:10px;padding:8px 10px;font:inherit}.ta{min-height:64px;resize:vertical}.row{display:flex;align-items:center;gap:8px}.sp{height:10px}.sp2{height:16px}.opt{width:100%;text-align:left;border:1px solid #e2e8f0;background:#fff;padding:10px;border-radius:14px}.opt.correct{border-color:#34d399;background:#ecfdf5}.opt.wrong{border-color:#fb7185;background:#fff1f2}.ex{margin-top:10px;border:1px solid #b6f4d7;background:#ebfff7;color:#065f46;padding:10px;border-radius:12px;font-size:13px}.bar{height:6px;border-radius:999px;background:#e2e8f0;overflow:hidden}.bar>span{display:block;height:100%;background:#10b981}.site-enter{opacity:0;transform:translateY(6px)}.site-enter.go{animation:pg .35s ease-out both}@keyframes pg{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:none}}.fab{position:fixed;right:12px;bottom:12px;display:flex;gap:6px;z-index:50}.fab .btn{border-radius:999px}.tbl{width:100%;border-collapse:collapse}.tbl th,.tbl td{border:1px solid #e2e8f0;padding:6px 8px;font-size:12px}.tbl th{background:#f1f5f9;text-align:left}footer{padding:12px;text-align:center;color:#64748b;font-size:12px}</style></head><body><div class="nav"><div class="navin"><div class="brand"><img id="brandLogo" class="logo" alt="logo"><div id="brandBadge" class="badge"></div><span id="brandTitle">Postest Bimbingan Perkawinan</span></div><div class="row" id="navActions"></div></div></div><main class="wrap" id="app"></main><footer>Â© <span id="y"></span> Â· <a href="#" id="dlHtmlLink">Unduh HTML</a></footer><div class="fab" id="fab" style="display:none"><button class="btn ghost" id="btnCopy">Salin Kode</button><button class="btn ghost" id="btnDownload">Unduh HTML</button></div><script>(function(){"use strict";const APP='Postest Bimbingan Perkawinan',KQ_D='postestQuestionsDraft',KQ_P='postestQuestionsPublished',KS='postestSettings',KA='postestAttempts',KN='postestParticipantName',KF='postestIsAdmin',DEF_PASS='admin123';const app=document.getElementById('app');document.getElementById('y').textContent=new Date().getFullYear();function uuid(){return window.crypto?.randomUUID?crypto.randomUUID():'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,c=>{const r=Math.random()*16|0,v=c==='x'?r:(r&0x3|0x8);return v.toString(16)})}const DEFAULT_Q=[
  {id:uuid(),text:'Apa tujuan utama dari pernikahan?',options:[
    {id:uuid(),text:'Mencari status sosial',isCorrect:false},
    {id:uuid(),text:'Mencari kebahagiaan duniawi semata',isCorrect:false},
    {id:uuid(),text:'Membangun ketenangan, cinta, dan kasih sayang (sakinah)',isCorrect:true},
    {id:uuid(),text:'Menghindari pajak',isCorrect:false}
  ],explanation:'Keluarga sakinah menekankan ketenangan (sakinah), cinta (mawaddah), dan kasih sayang (rahmah).'},

  {id:uuid(),text:'Dalam prosesi akad nikah di KUA, siapa yang berjabat tangan saat ijab kabul?',options:[
    {id:uuid(),text:'Penghulu dan mempelai perempuan',isCorrect:false},
    {id:uuid(),text:'Wali mempelai perempuan dan mempelai laki-laki',isCorrect:true},
    {id:uuid(),text:'Saksi dan mempelai laki-laki',isCorrect:false},
    {id:uuid(),text:'Orang tua mempelai laki-laki dan penghulu',isCorrect:false}
  ],explanation:'Yang berjabat tangan adalah wali mempelai perempuan dengan mempelai laki-laki.'},

  {id:uuid(),text:'Syarat sah nikah berikut yang benar adalahâ€¦',options:[
    {id:uuid(),text:'Cukup ada penghulu dan mempelai',isCorrect:false},
    {id:uuid(),text:'Harus ada wali, dua saksi, ijab kabul, dan mahar',isCorrect:true},
    {id:uuid(),text:'Cukup ada saksi tanpa wali',isCorrect:false},
    {id:uuid(),text:'Tidak perlu mahar',isCorrect:false}
  ],explanation:'Rukun/syarat sah nikah: wali, dua saksi, ijab kabul, mahar, dan mempelai.'},

  {id:uuid(),text:'Tujuan bimbingan perkawinan adalahâ€¦',options:[
    {id:uuid(),text:'Menghafal seluruh UU',isCorrect:false},
    {id:uuid(),text:'Meningkatkan kesiapan mental, pengetahuan, dan keterampilan komunikasi pasangan',isCorrect:true},
    {id:uuid(),text:'Menentukan jumlah tamu undangan',isCorrect:false},
    {id:uuid(),text:'Mengajarkan dekorasi pelaminan',isCorrect:false}
  ],explanation:'Bimwin menyiapkan pasangan secara mental, pengetahuan, dan skill komunikasi.'},

  {id:uuid(),text:'Mahar dalam pernikahan hukumnyaâ€¦',options:[
    {id:uuid(),text:'Wajib diberikan kepada mempelai perempuan',isCorrect:true},
    {id:uuid(),text:'Sunnah saja',isCorrect:false},
    {id:uuid(),text:'Makruh',isCorrect:false},
    {id:uuid(),text:'Haram',isCorrect:false}
  ],explanation:'Mahar adalah kewajiban suami kepada istri.'},

  {id:uuid(),text:'Ketika terjadi perselisihan, sikap yang dianjurkan pasangan adalahâ€¦',options:[
    {id:uuid(),text:'Menyalahkan pasangan di depan umum',isCorrect:false},
    {id:uuid(),text:'Diam berhari-hari',isCorrect:false},
    {id:uuid(),text:'Komunikasi yang baik dan mencari solusi bersama',isCorrect:true},
    {id:uuid(),text:'Minta orang lain memutuskan tanpa dialog',isCorrect:false}
  ],explanation:'Gunakan komunikasi yang baik dan penyelesaian masalah bersama.'},

  {id:uuid(),text:'Tanggung jawab suami-istri terkait nafkah yang tepat adalahâ€¦',options:[
    {id:uuid(),text:'Istri wajib menanggung seluruh nafkah',isCorrect:false},
    {id:uuid(),text:'Suami berkewajiban memberi nafkah, istri mengelola rumah tangga',isCorrect:true},
    {id:uuid(),text:'Keduanya tidak punya tanggung jawab',isCorrect:false},
    {id:uuid(),text:'Anak yang menanggung orang tua',isCorrect:false}
  ],explanation:'Secara umum suami menafkahi, istri mengelola rumah tangga (dapat berubah sesuai kesepakatan).'},

  {id:uuid(),text:'Yang termasuk adab hubungan suami istri adalahâ€¦',options:[
    {id:uuid(),text:'Saling menghormati dan menjaga privasi',isCorrect:true},
    {id:uuid(),text:'Membuka aib pasangan ke media sosial',isCorrect:false},
    {id:uuid(),text:'Tidak perlu izin dalam hal penting',isCorrect:false},
    {id:uuid(),text:'Meremehkan perasaan pasangan',isCorrect:false}
  ],explanation:'Adab berumah tangga: saling menghormati, menjaga privasi, dan musyawarah.'},

  {id:uuid(),text:'Peran saksi dalam akad nikah adalahâ€¦',options:[
    {id:uuid(),text:'Sebagai pihak yang mengesahkan ijab kabul',isCorrect:true},
    {id:uuid(),text:'Menentukan mahar',isCorrect:false},
    {id:uuid(),text:'Menggantikan wali',isCorrect:false},
    {id:uuid(),text:'Mewakili mempelai',isCorrect:false}
  ],explanation:'Saksi memastikan ijab kabul berlangsung sah dan terdengar jelas.'},

  {id:uuid(),text:'Contoh penerapan mawaddah wa rahmah dalam keluarga adalahâ€¦',options:[
    {id:uuid(),text:'Saling menghargai, tolong menolong, dan memaafkan',isCorrect:true},
    {id:uuid(),text:'Menang sendiri',isCorrect:false},
    {id:uuid(),text:'Tidak perlu komunikasi',isCorrect:false},
    {id:uuid(),text:'Menyimpan masalah',isCorrect:false}
  ],explanation:'Mawaddah wa rahmah tercermin dalam sikap saling sayang, menghargai, dan memaafkan.'}
];const DEFAULT_S={title:APP,shuffleQuestions:true,shuffleOptions:true,passScore:70,timeLimitMinutes:10,adminPass:DEF_PASS,heroSubtitle:'Postest ringkas dengan animasi halus.',logoUrl:'',publishedAt:''};const ls={g:k=>{try{return JSON.parse(localStorage.getItem(k))}catch{return null}},s:(k,v)=>localStorage.setItem(k,JSON.stringify(v))};function loadDraft(){const v=ls.g(KQ_D);return Array.isArray(v)&&v.length?v:loadPub()||DEFAULT_Q}function saveDraft(v){ls.s(KQ_D,v)}function loadPub(){const v=ls.g(KQ_P);return Array.isArray(v)&&v.length?v:null}function savePub(v){ls.s(KQ_P,v)}function loadS(){const raw=ls.g(KS);return raw?{...DEFAULT_S,...raw}:DEFAULT_S}function saveS(v){ls.s(KS,v);applyBrand(v)}function loadA(){return Array.isArray(ls.g(KA))?ls.g(KA):[]}function saveA(v){ls.s(KA,v)}function sh(a){const b=[...a];for(let i=b.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[b[i],b[j]]=[b[j],b[i]]}return b}function isAdmin(){return sessionStorage.getItem(KF)==='1'}function setAdmin(v){v?sessionStorage.setItem(KF,'1'):sessionStorage.removeItem(KF);updateNav()}function applyBrand(s){const img=document.getElementById('brandLogo'),badge=document.getElementById('brandBadge'),ttl=document.getElementById('brandTitle');ttl.textContent=s.title||APP;if(s.logoUrl){img.src=s.logoUrl;img.style.display='block';badge.style.display='none'}else{img.style.display='none';badge.style.display='block'}}function esc(x){return String(x).replace(/[&<>"']/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]))}function makeCSV(rows){return rows.map(r=>r.map(v=>`"${String(v).replace(/"/g,'""')}"`).join(',')).join('\n')}function exportCSV(){const rows=[['Timestamp','Nama','Skor','Benar','Total','Lulus','Durasi(dtk)']];loadA().forEach(a=>rows.push([a.ts,a.name,a.score,a.correct,a.total,a.passed?'YA':'TIDAK',a.durationSec]));const blob=new Blob([makeCSV(rows)],{type:'text/csv;charset=utf-8;'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download='rekap_postest.csv';a.click();URL.revokeObjectURL(url)}function removeOpt(q,oid,min=2){const n=q.options.filter(o=>o.id!==oid);if(n.length<min)return{next:q,removed:false};const noneCorrect=!n.some(o=>o.isCorrect);const norm=n.map((o,i)=>({...o,isCorrect:noneCorrect?i===0:o.isCorrect}));return{next:{...q,options:norm},removed:true}}function btn(t,cls,fn){const b=document.createElement('button');b.className=`btn ${cls||''}`.trim();b.textContent=t;b.onclick=fn;return b}function updateNav(){const nav=document.getElementById('navActions');nav.innerHTML='';nav.append(btn('Postest','ghost',()=>go('#/quiz')),btn('Admin','ghost',()=>go('#/admin')));if(isAdmin())nav.append(btn('Logout','dan',()=>{setAdmin(false);go('#/quiz')}));const fab=document.getElementById('fab');if(fab)fab.style.display=isAdmin()?'flex':'none';const c=document.getElementById('btnCopy');if(c)c.onclick=copySnap;const d=document.getElementById('btnDownload');if(d)d.onclick=downloadSnap}function go(h){if(location.hash!==h)location.hash=h;else route()}window.addEventListener('hashchange',route);function route(){const h=location.hash||'#/quiz';if(h.startsWith('#/admin')){if(!isAdmin())return login();return admin()}quiz()}updateNav();document.addEventListener('DOMContentLoaded',()=>{const l=document.getElementById('dlHtmlLink');if(l)l.onclick=e=>{e.preventDefault();downloadSnap()}});(function(){['.nav','#app'].forEach(sel=>{const el=sel==='#app'?document.getElementById('app'):document.querySelector(sel);if(el){el.classList.add('site-enter');requestAnimationFrame(()=>el.classList.add('go'))}})})();function getSnap(){const doc='<!doctype html>\n';const el=document.documentElement.cloneNode(true);el.querySelectorAll('.site-enter').forEach(x=>x.classList.remove('site-enter','go'));return doc+el.outerHTML}function downloadSnap(){const blob=new Blob([getSnap()],{type:'text/html;charset=utf-8'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download='postest_admin.html';a.click();URL.revokeObjectURL(url)}async function copySnap(){const h=getSnap();try{await navigator.clipboard.writeText(h);alert('Kode HTML disalin.')}catch(_){const t=document.createElement('textarea');t.value=h;document.body.appendChild(t);t.select();document.execCommand('copy');t.remove();alert('Kode HTML disalin (fallback).')}}function quiz(){const s=loadS();const raw=loadPub()||DEFAULT_Q;const qs=(s.shuffleQuestions?sh(raw):raw).map(q=>({...q,options:s.shuffleOptions?sh(q.options):q.options}));const tot=qs.length;let idx=0,ans={},show=false,time=s.timeLimitMinutes*60,t=null,cele=false,start=Date.now();let name=(localStorage.getItem(KN)||'').trim();if(s.timeLimitMinutes){t=setInterval(()=>{time--;if(time<=0){clearInterval(t);time=0;show=true;upd()}tick()},1000)}function pick(id){ans[qs[idx].id]=id;upd()}function next(){if(idx<tot-1){idx++;upd()}else{show=true;upd()}}function prev(){if(idx>0){idx--;upd()}}function calc(){let c=0;for(const q of qs){const a=ans[q.id];if(!a)continue;const o=q.options.find(x=>x.id===a);if(o?.isCorrect)c++}const sc=Math.round((c/Math.max(1,tot))*100);return{c,sc,pass:sc>=s.passScore}}function tick(){const el=document.getElementById('timeBadge');if(!el)return;if(s.timeLimitMinutes){const m=Math.floor(time/60),sec=String(time%60).padStart(2,'0');el.textContent=`Waktu: ${m}:${sec}`}else el.textContent='Tanpa Batas Waktu'}function conf(){const cols=['#22c55e','#16a34a','#10b981','#84cc16','#059669'];for(let i=0;i<50;i++){const d=document.createElement('div');d.style.cssText='position:fixed;top:-10vh;width:8px;height:14px;opacity:.9;border-radius:2px;pointer-events:none;animation:conf 2.1s ease-out forwards;';d.className='confetti';d.style.left=(Math.random()*100)+'vw';d.style.background=cols[i%cols.length];d.style.animationDuration=(1.6+Math.random()*1.2)+'s';d.style.animationDelay=(Math.random()*.3)+'s';document.body.appendChild(d);setTimeout(()=>d.remove(),2300)}}function saveAttempt(){const {c,sc,pass}=calc();const dur=Math.max(0,Math.round((Date.now()-start)/1000));const a={ts:new Date().toISOString(),name:name||'-',score:sc,correct:c,total:tot,passed:pass,durationSec:dur};const ar=loadA();ar.push(a);saveA(ar)}function header(){return `<div class="row" style="justify-content:space-between;flex-wrap:wrap"><div><div class="title">${esc(s.title)}</div><div class="sub">${esc(s.heroSubtitle||'')}</div><div class="sp"></div><div class="row" style="flex-wrap:wrap;gap:6px"><label class="lab" style="margin:0">Nama</label><input class="inp" id="pName" placeholder="Tulis nama" value="${esc(name)}" style="max-width:240px"></div></div><div class="row" style="gap:6px;flex-wrap:wrap"><span class="sub" style="border:1px solid #e2e8f0;border-radius:999px;padding:3px 8px">${tot} Soal</span><span class="sub" style="border:1px solid #e2e8f0;border-radius:999px;padding:3px 8px">Lulus â‰¥ ${s.passScore}%</span><span class="sub" id="timeBadge" style="border:1px solid #e2e8f0;border-radius:999px;padding:3px 8px"></span></div></div>`}function card(){const q=qs[idx],picked=ans[q.id];return `<div class="card"><div class="row" style="justify-content:space-between;margin-bottom:8px"><div class="sub">Soal ${idx+1}/${tot}</div><div class="bar" style="width:160px"><span style="width:${((idx+1)/tot)*100}%"></span></div></div><div class="sp"></div><div style="font-weight:700;color:#0f172a">${esc(q.text)}</div>${q.options.map(op=>{const on=picked===op.id,cl=on?(op.isCorrect?'opt correct':'opt wrong'):'opt';return `<button class="${cl}" data-role="opt" data-id="${op.id}"><div class="row" style="justify-content:space-between"><span>${esc(op.text)}</span>${on?`<span class="sub" style="font-weight:700;color:${op.isCorrect?'#047857':'#e11d48'}">${op.isCorrect?'Benar':'Kurang Tepat'}</span>`:''}</div></button>`}).join('')}${picked?`<div class="ex">${esc(q.explanation||'')}</div>`:''}<div class="sp2"></div><div class="row" style="justify-content:space-between"><button class="btn ghost" id="prev" ${idx===0?'disabled':''}>Kembali</button><button class="btn" id="next">${idx===tot-1?'Selesai':'Berikutnya'}</button></div></div>`}function result(){const {c,sc,pass}=calc();return `<div class="card"><div style="text-align:center"><div class="bar" style="max-width:420px;margin:0 auto 8px"><span style="width:${sc}%"></span></div><div class="title">Skor: ${sc}%</div><div class="sub">Benar ${c} dari ${tot} soal</div><div style="margin-top:6px;font-weight:800;color:${pass?'#059669':'#e11d48'}">${pass?'LULUS ðŸŽ‰':'Belum lulus'}</div></div><div class="sp2"></div><div class="row" style="justify-content:center;gap:6px;flex-wrap:wrap"><button class="btn" id="reload">Ulangi</button><button class="btn ghost" id="csv">Unduh Rekap (CSV)</button></div></div>`}function upd(){app.innerHTML=`${header()}<div class="sp2"></div>${!show?card():result()}`;tick();const ni=app.querySelector('#pName');if(ni)ni.oninput=e=>{name=e.target.value;localStorage.setItem(KN,name)};app.querySelectorAll('[data-role="opt"]').forEach(b=>b.onclick=()=>pick(b.getAttribute('data-id')));const p=app.querySelector('#prev');if(p)p.onclick=prev;const n=app.querySelector('#next');if(n)n.onclick=()=>{if(idx===tot-1&&!show)saveAttempt();next()};const rl=app.querySelector('#reload');if(rl)rl.onclick=()=>quiz();const csv=app.querySelector('#csv');if(csv)csv.onclick=exportCSV;if(show){const {pass}=calc();if(pass&&!cele){cele=true;conf();setTimeout(()=>cele=false,2200)}}}upd()}function login(){const s=loadS();app.innerHTML=`<div class="card" style="max-width:480px;margin:0 auto"><div class="title" style="margin-bottom:4px">Masuk Admin</div><div class="sub" style="margin-bottom:8px">Masukkan kata sandi admin.</div><label class="lab">Kata Sandi</label><input class="inp" type="password" id="pass" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢"><div class="sp2"></div><div class="row" style="justify-content:space-between;gap:6px;flex-wrap:wrap"><button class="btn" id="go">Masuk</button><button class="btn ghost" id="bk">Kembali</button></div></div>`;document.getElementById('go').onclick=()=>{const v=document.getElementById('pass').value;if(v===(s.adminPass||DEF_PASS)){setAdmin(true);go('#/admin')}else alert('Kata sandi salah.')};document.getElementById('bk').onclick=()=>go('#/quiz')}function admin(){const S=loadS();let Q=loadDraft(),flt='';function save(){saveS(S);saveDraft(Q)}function publish(){savePub(Q);S.publishedAt=new Date().toISOString();saveS(S);alert('Draft berhasil dipublikasikan. Peserta sekarang akan mengerjakan versi terbaru.')}function addQ(){Q=[{id:uuid(),text:'[Tulis pertanyaan]',options:[{id:uuid(),text:'Pilihan A',isCorrect:true},{id:uuid(),text:'Pilihan B',isCorrect:false},{id:uuid(),text:'Pilihan C',isCorrect:false},{id:uuid(),text:'Pilihan D',isCorrect:false}],explanation:'[Penjelasan singkat]'},...Q];save()}function delQ(id){if(!confirm('Hapus soal ini?'))return;Q=Q.filter(x=>x.id!==id);save();ui()}function updQ(id,p){Q=Q.map(x=>x.id===id?{...x,...p}:x);save()}function updO(qid,oid,p){Q=Q.map(x=>x.id!==qid?x:{...x,options:x.options.map(o=>o.id===oid?{...o,...p}:o)});save()}function addO(qid){Q=Q.map(x=>x.id!==qid?x:{...x,options:[...x.options,{id:uuid(),text:'Pilihan baru',isCorrect:false}]});save();ui()}function remO(qid,oid){Q=Q.map(x=>{if(x.id!==qid)return x;const {next,removed}=removeOpt(x,oid,2);if(!removed){alert('Minimal 2 opsi.');return x}return next});save();ui()}function markT(qid,oid){Q=Q.map(x=>x.id!==qid?x:{...x,options:x.options.map(o=>({...o,isCorrect:o.id===oid}))});save();ui()}function expJSON(){const b=new Blob([JSON.stringify({settings:S,questions:Q},null,2)],{type:'application/json'});const u=URL.createObjectURL(b);const a=document.createElement('a');a.href=u;a.download='postest_draft.json';a.click();URL.revokeObjectURL(u)}function impJSON(e){const f=e.target.files?.[0];if(!f)return;const r=new FileReader();r.onload=()=>{try{const d=JSON.parse(r.result);if(d.settings){Object.assign(S,DEFAULT_S,d.settings);saveS(S)}if(Array.isArray(d.questions)){Q=d.questions;saveDraft(Q)}alert('Import draft berhasil.');ui()}catch{alert('File tidak valid.')}};r.readAsText(f);e.target.value=''}function drawList(){const list=document.getElementById('qList'),empty=document.getElementById('emptyMsg');const items=Q.filter(q=>!flt||q.text.toLowerCase().includes(flt));empty.style.display=items.length?'none':'block';document.getElementById('qCount').textContent=Q.length;list.innerHTML=items.map((q,i)=>`<div class="card" data-qid="${q.id}"><div class="row" style="justify-content:space-between;margin-bottom:6px"><div class="sub">Soal #${i+1}</div><button class="btn ghost" data-act="del">Hapus</button></div><label class="lab">Pertanyaan</label><textarea class="ta" data-act="qtext">${esc(q.text)}</textarea><div class="sp"></div><div style="display:grid;gap:8px;grid-template-columns:repeat(auto-fit,minmax(240px,1fr))">${q.options.map(o=>`<div class="card" style="border-color:${o.isCorrect?'#34d399':'#e2e8f0'}" data-oid="${o.id}"><div class="row" style="justify-content:space-between;margin-bottom:6px"><div class="sub">Opsi</div><div class="row" style="gap:6px"><button class="btn ghost" data-act="setT">Jadikan Benar</button><button class="btn dan" data-act="delO">Hapus</button></div></div><input class="inp" data-act="otext" value="${esc(o.text)}"></div>`).join('')}</div><div class="sp"></div><button class="btn ghost" data-act="addO">+ Tambah Opsi</button><div class="sp"></div><label class="lab">Penjelasan</label><textarea class="ta" data-act="qexp">${esc(q.explanation||'')}</textarea></div>`).join('');list.querySelectorAll('[data-qid]').forEach(box=>{const qid=box.getAttribute('data-qid');box.querySelector('[data-act="del"]').onclick=()=>delQ(qid);box.querySelector('[data-act="qtext"]').oninput=e=>updQ(qid,{text:e.target.value});box.querySelector('[data-act="qexp"]').oninput=e=>updQ(qid,{explanation:e.target.value});const add=box.querySelector('[data-act="addO"]');if(add)add.onclick=()=>addO(qid);box.querySelectorAll('[data-oid]').forEach(op=>{const oid=op.getAttribute('data-oid');op.querySelector('[data-act="setT"]').onclick=()=>markT(qid,oid);op.querySelector('[data-act="delO"]').onclick=()=>remO(qid,oid);op.querySelector('[data-act="otext"]').oninput=e=>updO(qid,oid,{text:e.target.value})})})}function drawRekap(){const tb=document.querySelector('#rekap tbody');const d=loadA();tb.innerHTML=d.map((a,i)=>`<tr><td>${i+1}</td><td>${a.ts}</td><td>${esc(a.name)}</td><td>${a.score}</td><td>${a.correct}</td><td>${a.total}</td><td>${a.passed?'YA':'TIDAK'}</td><td>${a.durationSec}</td></tr>`).join('')}function ui(){const pubCount=(loadPub()?.length)||0;const pubAt=esc(S.publishedAt?new Date(S.publishedAt).toLocaleString():"Belum pernah");app.innerHTML=`<div class="row" style="justify-content:space-between;flex-wrap:wrap;gap:8px"><div><div class="title">Admin â€¢ ${esc(S.title)}</div><div class="sub">Kelola **Draft** soal lalu publikasikan untuk peserta.</div></div><div class="row" style="gap:6px"><button class="btn ghost" id="v">Lihat Postest</button><button class="btn dan" id="lo">Logout</button><button class="btn" id="add">+ Soal</button></div></div><div class="sp2"></div><div class="card"><div class="row" style="justify-content:space-between;gap:8px;flex-wrap:wrap"><div><div style="font-weight:800">Status Publikasi</div><div class="sub">Terbit: ${pubAt} â€¢ Soal Terbit: ${pubCount}</div></div><div class="row" style="gap:6px"><button class="btn mute" id="save">Simpan Draft</button><button class="btn" id="pub">Publikasikan</button></div></div><div class="sp"></div><div class="row" style="gap:8px;flex-wrap:wrap"><div style="flex:1 1 240px"><label class="lab">Judul</label><input class="inp" id="t" value="${esc(S.title)}"></div><div style="flex:1 1 240px"><label class="lab">Subjudul</label><input class="inp" id="sub" value="${esc(S.heroSubtitle)}"></div><div style="flex:1 1 120px"><label class="lab">Lulus (%)</label><input class="inp" id="ps" type="number" min="0" max="100" value="${S.passScore}"></div><div style="flex:1 1 140px"><label class="lab">Waktu (menit)</label><input class="inp" id="tm" type="number" min="0" value="${S.timeLimitMinutes}"></div><div style="flex:1 1 180px"><label class="lab">Acak Soal</label><button class="btn ghost" id="sq">${S.shuffleQuestions?'YA':'TIDAK'}</button></div><div style="flex:1 1 180px"><label class="lab">Acak Opsi</label><button class="btn ghost" id="so">${S.shuffleOptions?'YA':'TIDAK'}</button></div><div style="flex:1 1 240px"><label class="lab">Sandi Admin</label><input class="inp" id="ap" value="${esc(S.adminPass)}"></div><div style="flex:1 1 320px"><label class="lab">Logo URL</label><input class="inp" id="lg" placeholder="https://.../logo.png" value="${esc(S.logoUrl||'')}"><div class="sub">Logo tampil di kiri judul.</div></div></div><div class="sp"></div><div class="row" style="gap:6px;flex-wrap:wrap"><button class="btn" id="ex">Export Draft</button><label class="btn ghost" style="cursor:pointer"><input type="file" id="im" accept="application/json" style="display:none">Import Draft</label></div></div><div class="sp2"></div><div class="card"><div class="row" style="justify-content:space-between;gap:6px;flex-wrap:wrap"><div style="font-weight:800">Bank Soal (Draft) (<span id="qCount">${Q.length}</span>)</div><input class="inp" id="f" placeholder="Cari soal..." style="max-width:260px"></div><div class="sp"></div><div id="qList" style="display:grid;gap:10px"></div><div id="emptyMsg" class="sub" style="display:none">Tidak ada soal.</div></div><div class="sp2"></div><div class="card"><div style="font-weight:800;margin-bottom:6px">Rekap Nilai</div><div class="row" style="gap:6px;flex-wrap:wrap;margin-bottom:8px"><button class="btn ghost" id="csv2">Unduh Rekap (CSV)</button><button class="btn dan" id="clr">Bersihkan Rekap</button></div><div style="max-height:280px;overflow:auto"><table class="tbl" id="rekap"><thead><tr><th>#</th><th>Waktu</th><th>Nama</th><th>Skor</th><th>Benar</th><th>Total</th><th>Lulus</th><th>Durasi</th></tr></thead><tbody></tbody></table></div></div><div class="sub">Draft & pengaturan tersimpan otomatis (localStorage). Klik <b>Publikasikan</b> agar peserta mendapat versi terbaru.</div>`;document.getElementById('v').onclick=()=>go('#/quiz');document.getElementById('lo').onclick=()=>{setAdmin(false);go('#/quiz')};document.getElementById('add').onclick=()=>{addQ();drawList()};document.getElementById('save').onclick=()=>{save();alert('Draft tersimpan. (tersimpan otomatis juga setiap perubahan)')};document.getElementById('pub').onclick=publish;document.getElementById('ex').onclick=expJSON;document.getElementById('im').onchange=impJSON;document.getElementById('f').oninput=e=>{flt=e.target.value.toLowerCase();drawList()};document.getElementById('csv2').onclick=exportCSV;document.getElementById('clr').onclick=()=>{if(confirm('Hapus semua rekap?')){saveA([]);drawRekap()}};document.getElementById('t').oninput=e=>{S.title=e.target.value;saveS(S)};document.getElementById('sub').oninput=e=>{S.heroSubtitle=e.target.value;saveS(S)};document.getElementById('ps').oninput=e=>{S.passScore=+e.target.value||0;saveS(S)};document.getElementById('tm').oninput=e=>{S.timeLimitMinutes=+e.target.value||0;saveS(S)};document.getElementById('ap').oninput=e=>{S.adminPass=e.target.value;saveS(S)};document.getElementById('lg').oninput=e=>{S.logoUrl=e.target.value;saveS(S)};document.getElementById('sq').onclick=()=>{S.shuffleQuestions=!S.shuffleQuestions;saveS(S);ui()};document.getElementById('so').onclick=()=>{S.shuffleOptions=!S.shuffleOptions;saveS(S);ui()};drawList();drawRekap()}function drawList(){const list=document.getElementById('qList'),empty=document.getElementById('emptyMsg');const items=Q.filter(q=>!flt||q.text.toLowerCase().includes(flt));empty.style.display=items.length?'none':'block';document.getElementById('qCount').textContent=Q.length;list.innerHTML=items.map((q,i)=>`<div class="card" data-qid="${q.id}"><div class="row" style="justify-content:space-between;margin-bottom:6px"><div class="sub">Soal #${i+1}</div><button class="btn ghost" data-act="del">Hapus</button></div><label class="lab">Pertanyaan</label><textarea class="ta" data-act="qtext">${esc(q.text)}</textarea><div class="sp"></div><div style="display:grid;gap:8px;grid-template-columns:repeat(auto-fit,minmax(240px,1fr))">${q.options.map(o=>`<div class="card" style="border-color:${o.isCorrect?'#34d399':'#e2e8f0'}" data-oid="${o.id}"><div class="row" style="justify-content:space-between;margin-bottom:6px"><div class="sub">Opsi</div><div class="row" style="gap:6px"><button class="btn ghost" data-act="setT">Jadikan Benar</button><button class="btn dan" data-act="delO">Hapus</button></div></div><input class="inp" data-act="otext" value="${esc(o.text)}"></div>`).join('')}</div><div class="sp"></div><button class="btn ghost" data-act="addO">+ Tambah Opsi</button><div class="sp"></div><label class="lab">Penjelasan</label><textarea class="ta" data-act="qexp">${esc(q.explanation||'')}</textarea></div>`).join('');list.querySelectorAll('[data-qid]').forEach(box=>{const qid=box.getAttribute('data-qid');box.querySelector('[data-act="del"]').onclick=()=>delQ(qid);box.querySelector('[data-act="qtext"]').oninput=e=>updQ(qid,{text:e.target.value});box.querySelector('[data-act="qexp"]').oninput=e=>updQ(qid,{explanation:e.target.value});const add=box.querySelector('[data-act="addO"]');if(add)add.onclick=()=>addO(qid);box.querySelectorAll('[data-oid]').forEach(op=>{const oid=op.getAttribute('data-oid');op.querySelector('[data-act="setT"]').onclick=()=>markT(qid,oid);op.querySelector('[data-act="delO"]').onclick=()=>remO(qid,oid);op.querySelector('[data-act="otext"]').oninput=e=>updO(qid,oid,{text:e.target.value})})})}function drawRekap(){const tb=document.querySelector('#rekap tbody');const d=loadA();tb.innerHTML=d.map((a,i)=>`<tr><td>${i+1}</td><td>${a.ts}</td><td>${esc(a.name)}</td><td>${a.score}</td><td>${a.correct}</td><td>${a.total}</td><td>${a.passed?'YA':'TIDAK'}</td><td>${a.durationSec}</td></tr>`).join('')}ui()}function getSnapshotHTML(){return getSnap()}function downloadSnapshot(){return downloadSnap()}function copySnapshot(){return copySnap()}function renderQuiz(){return quiz()}function renderAdmin(){return admin()}function renderLogin(){return login()}function removeOptionFromQuestion(q,oid,min){return removeOpt(q,oid,min)}})();</script></body></html>
